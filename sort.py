"""
–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –Ω–∞ Python
–í —ç—Ç–æ–º —Ñ–∞–π–ª–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–≤–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏.
"""

def bubble_sort(arr):
    """
    –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—É–∑—ã—Ä—å–∫–æ–º (Bubble Sort)
    
    –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:
    - –•—É–¥—à–∏–π —Å–ª—É—á–∞–π: O(n¬≤)
    - –õ—É—á—à–∏–π —Å–ª—É—á–∞–π: O(n) (—É–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤)
    
    –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: O(1)
    
    Args:
        arr (list): –°–ø–∏—Å–æ–∫ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        
    Returns:
        list: –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
    """
    n = len(arr)
    # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
    for i in range(n):
        # –§–ª–∞–≥ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ - –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ –æ–±–º–µ–Ω–æ–≤, –º–∞—Å—Å–∏–≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
        swapped = False
        
        # –ü–æ—Å–ª–µ–¥–Ω–∏–µ i —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–∂–µ –Ω–∞ —Å–≤–æ–∏—Ö –º–µ—Å—Ç–∞—Ö
        for j in range(0, n - i - 1):
            # –ú–µ–Ω—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –º–µ—Å—Ç–∞–º–∏, –µ—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –±–æ–ª—å—à–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ
            if arr[j] > arr[j + 1]:
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
                swapped = True
                
        # –ï—Å–ª–∏ –Ω–µ –±—ã–ª–æ –æ–±–º–µ–Ω–æ–≤, –≤—ã—Ö–æ–¥–∏–º
        if not swapped:
            break
    
    return arr


def quick_sort(arr):
    """
    –ë—ã—Å—Ç—Ä–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (Quick Sort)
    
    –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:
    - –°—Ä–µ–¥–Ω–∏–π —Å–ª—É—á–∞–π: O(n log n)
    - –•—É–¥—à–∏–π —Å–ª—É—á–∞–π: O(n¬≤) (—Ä–µ–¥–∫–æ, –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–º –≤—ã–±–æ—Ä–µ –æ–ø–æ—Ä–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞)
    
    –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: O(log n) (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –≤—ã–∑–æ–≤—ã)
    
    Args:
        arr (list): –°–ø–∏—Å–æ–∫ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        
    Returns:
        list: –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
    """
    # –ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π —Ä–µ–∫—É—Ä—Å–∏–∏
    if len(arr) <= 1:
        return arr
    
    # –í—ã–±–∏—Ä–∞–µ–º –æ–ø–æ—Ä–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç (—Å–µ—Ä–µ–¥–∏–Ω–∞ –º–∞—Å—Å–∏–≤–∞)
    pivot = arr[len(arr) // 2]
    
    # –†–∞–∑–¥–µ–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Ç—Ä–∏ –≥—Ä—É–ø–ø—ã
    left = [x for x in arr if x < pivot]    # –≠–ª–µ–º–µ–Ω—Ç—ã –º–µ–Ω—å—à–µ –æ–ø–æ—Ä–Ω–æ–≥–æ
    middle = [x for x in arr if x == pivot] # –≠–ª–µ–º–µ–Ω—Ç—ã —Ä–∞–≤–Ω—ã–µ –æ–ø–æ—Ä–Ω–æ–º—É
    right = [x for x in arr if x > pivot]   # –≠–ª–µ–º–µ–Ω—Ç—ã –±–æ–ª—å—à–µ –æ–ø–æ—Ä–Ω–æ–≥–æ
    
    # –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ª–µ–≤—É—é –∏ –ø—Ä–∞–≤—É—é —á–∞—Å—Ç–∏
    return quick_sort(left) + middle + quick_sort(right)


def test_sorting_algorithms():
    """
    –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
    """
    test_cases = [
        # –¢–µ—Å—Ç 1: –û–±—ã—á–Ω—ã–π —Å–ª—É—á–∞–π
        [64, 34, 25, 12, 22, 11, 90],
        
        # –¢–µ—Å—Ç 2: –ù–µ–±–æ–ª—å—à–æ–π –º–∞—Å—Å–∏–≤
        [5, 2, 8, 1, 9],
        
        # –¢–µ—Å—Ç 3: –£–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
        [1, 2, 3, 4, 5],
        
        # –¢–µ—Å—Ç 4: –ú–∞—Å—Å–∏–≤ –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
        [5, 4, 3, 2, 1],
        
        # –¢–µ—Å—Ç 5: –û–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç
        [42],
        
        # –¢–µ—Å—Ç 6: –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
        [],
        
        # –¢–µ—Å—Ç 7: –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞
        [-5, -1, -3, 0, 4, 2],
        
        # –¢–µ—Å—Ç 8: –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã
        [3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5],
    ]
    
    print("üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏")
    print("=" * 50)
    
    for i, test_arr in enumerate(test_cases, 1):
        print(f"\n–¢–µ—Å—Ç {i}: {test_arr}")
        
        # –ö–æ–ø–∏—Ä—É–µ–º –º–∞—Å—Å–∏–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
        arr1 = test_arr.copy()
        arr2 = test_arr.copy()
        
        # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—É–∑—ã—Ä—å–∫–æ–º
        bubble_result = bubble_sort(arr1)
        print(f"  –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—É–∑—ã—Ä—å–∫–æ–º: {bubble_result}")
        
        # –ë—ã—Å—Ç—Ä–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
        quick_result = quick_sort(arr2)
        print(f"  –ë—ã—Å—Ç—Ä–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:   {quick_result}")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
        expected = sorted(test_arr)
        if bubble_result == expected and quick_result == expected:
            print("  ‚úÖ –û–ö")
        else:
            print("  ‚ùå –û—à–∏–±–∫–∞!")
            print(f"  –û–∂–∏–¥–∞–ª–æ—Å—å: {expected}")
    
    print("\n" + "=" * 50)
    print("‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!")


def benchmark_sorting():
    """
    –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
    """
    import random
    import time
    
    print("\nüìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏")
    print("=" * 50)
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
    test_sizes = [10, 100, 1000]
    
    for size in test_sizes:
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –º–∞—Å—Å–∏–≤
        test_data = [random.randint(1, 10000) for _ in range(size)]
        
        print(f"\n–†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞: {size} —ç–ª–µ–º–µ–Ω—Ç–æ–≤")
        
        # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –ø—É–∑—ã—Ä—å–∫–æ–º (—Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤)
        if size <= 1000:
            data = test_data.copy()
            start = time.time()
            bubble_sort(data)
            bubble_time = time.time() - start
            print(f"  –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—É–∑—ã—Ä—å–∫–æ–º: {bubble_time:.6f} —Å–µ–∫—É–Ω–¥")
        
        # –¢–µ—Å—Ç–∏—Ä—É–µ–º –±—ã—Å—Ç—Ä—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
        data = test_data.copy()
        start = time.time()
        quick_sort(data)
        quick_time = time.time() - start
        print(f"  –ë—ã—Å—Ç—Ä–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:   {quick_time:.6f} —Å–µ–∫—É–Ω–¥")
        
        # –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ Python –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
        data = test_data.copy()
        start = time.time()
        sorted(data)
        python_time = time.time() - start
        print(f"  sorted() Python:      {python_time:.6f} —Å–µ–∫—É–Ω–¥")


if __name__ == "__main__":
    # –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
    test_sorting_algorithms()
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–µ–Ω—á–º–∞—Ä–∫ (–º–æ–∂–Ω–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∞)
    benchmark_sorting()
    
    # –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    print("\nüéØ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:")
    example = [38, 27, 43, 3, 9, 82, 10]
    print(f"–ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: {example}")
    print(f"Bubble Sort: {bubble_sort(example.copy())}")
    print(f"Quick Sort:  {quick_sort(example.copy())}")
